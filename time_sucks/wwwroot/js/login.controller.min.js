angular.module("time").controller("LoginCtrl",["$scope","$http","$routeParams","$location","usSpinnerService",function(n,t,i,r,u){n.loaded=!1;n.user={};n.password="";n.load=function(){n.login=function(){if(n.user.username===""){toastr.error("Please enter a Username");return}if(n.password===""){toastr.error("Please enter a Password");return}n.user.password=CryptoJS.SHA256(n.password).toString(CryptoJS.enc.Hex);u.spin("spinner");t.post("/Home/LoginUser",n.user).then(function(n){u.stop("spinner");n.status===204?toastr.error("Username does not exist."):r.path("/dashboard")},function(n){u.stop("spinner");n.status===401?toastr.error("Password incorrect."):n.status===403&&toastr.error("User account has been deactivated.")})};n.register=function(){r.path("/register")};n.loaded=!0;$("#username").focus()};n.$parent.user&&n.$parent.user!==""?n.$parent.user.type==="A"||n.$parent.user.type==="I"?r.path("/courses"):r.path("/dashboard"):t.get("/Home/CheckSession").then(function(t){if(t.data===""){n.load();return}n.$parent.user=t.data;n.$parent.loaded=!0;n.$parent.user.type==="A"||n.$parent.user.type==="I"?r.path("/courses"):r.path("/dashboard")},function(){n.$parent.loaded=!0;n.load()})}]);